---
title: "What's is new in the second edition of Geocomputation with R: part 1"
author: Jakub Nowosad, Robin Lovelace, Jannes Muenchow
date: "2022-01-30"
slug: geocompr2-bp2
categories: [updates]
tags: [geocompr, geocompr2, sf, sp, stars, raster, terra, tmap, rstats]
draft: true
---

<!-- intro -->
Geocomputation with R is a book on geographic data analysis, visualization, and modeling.
Its first edition was published in 2019 and reached about 500k people via the website at https://geocompr.robinlovelace.net/ and [the physical book](https://www.routledge.com/9781138304512). 
The book also contributes to many university courses, lectures, and personal development as outlined at https://geocompr.github.io/guestbook/.
Tools and methods for spatial data analysis are still quickly evolving, and thus we decided in September 2021 to start working on the second edition of the book.
At the time of writing this blog post, we made a lot of alterations to the first part of the book called *Foundations*, and the main role of this document is to list and explain the changes.
The second edition (work in progress) is available at https://geocompr.robinlovelace.net/, while you can find the first edition at https://bookdown.org/robinlovelace/geocompr/.

## Major changes

Several major changes happened to #rspatial since release of the first version of the book.
Most importantly:^[There are also other important changes, such as retirement of **RQGIS** and **mlr**, but we plan to focus on them while updating the second part of the book.]

- PROJ library was largely refactored, which have had an impact on a plethora of GIS software, including R spatial packages
- The **raster** package, highlighted in the 1st edition, is now being replaced by its successor **terra**

![](/post/2022/geocompr2-bp2_files/ch2fig.png)

Both of these changes are now addressed in Geocomputation with R. 
Chapter ["Reprojecting geographic data"](https://geocompr.robinlovelace.net/reproj-geo-data.html) undergone numerous modifications, including explanation of the currently recommend WKT coordinate reference systems representation, information on how to get and set CRSs, or much improved section on creating custom projections.
Similarly, we already replaced **raster**'s descriptions and functions with **terra** in the first eight chapters of the book.

## Changes to specific chapters

Additionally, almost all chapter received significant edits.
Section [The history of R-spatial](https://geocompr.robinlovelace.net/intro.html#the-history-of-r-spatial) in 1st chapter was updated with summary of various new #rspatial developments, including **terra**, **stars**, **lidR**, **rayshader**, **ggspatial**, **mapsf**, etc.
We also used this section to highlight that packages [**rgdal**, **rgeos**, and **maptools** will be retired at the end of 2023](https://stat.ethz.ch/pipermail/r-sig-geo/2021-September/028760.html) and that anyone still using these packages should "**transition to sf/stars/terra functions using GDAL and PROJ at your earliest convenience**"."

Second chapter got an information about **s2**, an interface to spherical geometry library already used by the **sf** package, and a [comparison between **terra** and **stars**](https://geocompr.robinlovelace.net/spatial-class.html#r-packages-for-working-with-raster-data).

In Chapter 4, we added [improved communication of binary spatial predicates in Chapter 4](https://geocompr.robinlovelace.net/spatial-operations.html#topological-relations) and a new  [section](https://geocompr.robinlovelace.net/spatial-operations.html#de-9im-strings) on the dimensionally extended 9 intersection model (DE-9IM).

![](/post/2022/geocompr2-bp2_files/ch4fig.png)

The vector part of Chapter 5 received [a new section on the links between subsetting and clipping](https://geocompr.robinlovelace.net/geometric-operations.html#subsetting-and-clipping), while the raster part got a much improved [part on resampling methods](https://geocompr.robinlovelace.net/geometric-operations.html#resampling).
We also decided to split out the text related raster-vector interactions into [a new 6th chapter](https://geocompr.robinlovelace.net/raster-vector.html).

Finally, [Chapter 8](https://geocompr.robinlovelace.net/read-write.html#read-write) got a bunch of improvements, including mentions of more data packages, alternative ways or reading-in OSM data, a part about geocoding, and information about Cloud Optimized GeoTIFF (COG).
We also spent some time to show how to [read just a part of vector data file using OGR SQL queries and WKT filters](https://geocompr.robinlovelace.net/read-write.html#iovec), and [extract only a portion of a COG raster file](https://geocompr.robinlovelace.net/read-write.html#raster-data-read). 

![](/post/2022/geocompr2-bp2_files/ch8fig.png)

## Book infrastructure

We also decided that the 2nd edition is a good time to improve the book infrastructure, i.e. data packages, storage of the exercises and solutions, automatic book builds, etc.

- new style - Customize the look of text blocks

- Saved some R spatial objects to files in both spData and spDataLarge - this way, we can read data using raster/terra/stars, instead of just loading one package's class object into R memory
- Created external website for solutions
- Refactor build settings so the book builds on Docker images in the [geocompr/docker](https://github.com/geocompr/docker) repo
- Improve the experience of using the book in Binder (ideal for trying out the code before installing or updating the necessary R packages), as documented in issue [#691](https://github.com/Robinlovelace/geocompr/issues/691) (thanks to [yuvipanda](https://github.com/yuvipanda))


## Minor changes

The book received also (almost) countless minor changes, including rephrasing of many concepts and reordering of our prose to make some concepts easier to understand.
We also reworked several plots using the **tmap** package to improve the visual consistency of the book.

![](/post/2022/geocompr2-bp2_files/figtmap.png)

- Many small changes...


<!-- outro -->

- issues/suggestions/PRs
- thanks to some people?
- ask people for their opinions?
